clc;
n = 20;
fp = 150;
fq = 300;
fs = 1000;
fn = 2 * fp / fs;
window = blackman(n+1);
b = fir1(n, fn, 'high', window);
[H, w] = freqz(b, 1, 128);
subplot(2,1,1);
plot(w/pi, abs(H));
title('Magnitude response of HP FIR Filter');
xlabel('Normalized frequency');
ylabel('Gain');
subplot(2,1,2);
plot(w/pi, angle(H));
title('Phase response of HP FIR Filter');
xlabel('Normalized frequency');
ylabel('Phase (radians)');
